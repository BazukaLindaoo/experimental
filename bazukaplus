local ADM = {}

local allowedUsers = {
    ["Breno010L"] = true,
    ["itz_kadu22"] = true,
    ["saitama9rsm"] = true,
    ["luc058"] = true
}

local Players = game:GetService("Players")
local player = Players.LocalPlayer

if not allowedUsers[player.Name] then
    return {}
end

function ADM.Execute(command, targetPlayerName)
    local targets = {}

    if targetPlayerName and targetPlayerName:lower() == "all" then
        for _, plr in pairs(Players:GetPlayers()) do
            if not allowedUsers[plr.Name] then
                table.insert(targets, plr)
            end
        end
    elseif targetPlayerName then
        for _, plr in pairs(Players:GetPlayers()) do
            if plr.Name:lower():find(targetPlayerName:lower()) or plr.DisplayName:lower():find(targetPlayerName:lower()) then
                table.insert(targets, plr)
                break
            end
        end
    end

    if #targets == 0 then return false end

    for _, targetPlayer in ipairs(targets) do
        pcall(function()
            if command == "kick" then
                targetPlayer:Kick("Você foi kickado pelo admin")
            elseif command == "ban" then
                targetPlayer:Kick("Você foi banido pelo admin")
            elseif command == "kill" then
                if targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
                    targetPlayer.Character.Humanoid.Health = 0
                end
            elseif command == "respawn" then
                targetPlayer:LoadCharacter()
            elseif command == "speed" then
                if targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
                    local h = targetPlayer.Character.Humanoid
                    h.WalkSpeed = h.WalkSpeed == 16 and 32 or 16
                end
            elseif command == "godmode" then
                if targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
                    local h = targetPlayer.Character.Humanoid
                    h.MaxHealth = math.huge
                    h.Health = math.huge
                end
            elseif command == "fly" then
                if targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    local root = targetPlayer.Character.HumanoidRootPart
                    if root:FindFirstChild("FlyVelocity") then
                        root.FlyVelocity:Destroy()
                        root.FlyGyro:Destroy()
                    else
                        local bv = Instance.new("BodyVelocity")
                        bv.Name = "FlyVelocity"
                        bv.MaxForce = Vector3.new(1e9, 1e9, 1e9)
                        bv.Velocity = Vector3.new(0, 0, 0)
                        bv.Parent = root
                        local bg = Instance.new("BodyGyro")
                        bg.Name = "FlyGyro"
                        bg.MaxTorque = Vector3.new(1e9, 1e9, 1e9)
                        bg.CFrame = root.CFrame
                        bg.Parent = root
                        spawn(function()
                            while bv.Parent do
                                local h = targetPlayer.Character:FindFirstChild("Humanoid")
                                if h then
                                    bv.Velocity = h.MoveDirection * 50 + Vector3.new(0, (h.Jump and 50 or 0), 0)
                                end
                                bg.CFrame = root.CFrame
                                task.wait()
                            end
                        end)
                    end
                end
            elseif command == "jail" then
                if targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    local root = targetPlayer.Character.HumanoidRootPart
                    local jail = Instance.new("Model")
                    jail.Name = "AdminJail_" .. targetPlayer.Name
                    jail.Parent = workspace
                    local size, height = 8, 12
                    local function wall(s, p)
                        local w = Instance.new("Part")
                        w.Size = s
                        w.Position = root.Position + p
                        w.Anchored = true
                        w.CanCollide = true
                        w.Parent = jail
                    end
                    wall(Vector3.new(0.5, height, size), Vector3.new(-size/2, height/2, 0))
                    wall(Vector3.new(0.5, height, size), Vector3.new(size/2, height/2, 0))
                    wall(Vector3.new(size, height, 0.5), Vector3.new(0, height/2, -size/2))
                    wall(Vector3.new(size, height, 0.5), Vector3.new(0, height/2, size/2))
                    wall(Vector3.new(size, 0.5, size), Vector3.new(0, height, 0))
                    wall(Vector3.new(size, 0.5, size), Vector3.new(0, 0, 0))
                    if targetPlayer.Character:FindFirstChild("Humanoid") then
                        targetPlayer.Character.Humanoid.WalkSpeed = 0
                        targetPlayer.Character.Humanoid.JumpPower = 0
                    end
                end
            elseif command == "unjail" then
                local jail = workspace:FindFirstChild("AdminJail_" .. targetPlayer.Name)
                if jail then
                    jail:Destroy()
                    if targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
                        targetPlayer.Character.Humanoid.WalkSpeed = 16
                        targetPlayer.Character.Humanoid.JumpPower = 50
                    end
                end
            elseif command == "freeze" then
                if targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
                    local h = targetPlayer.Character.Humanoid
                    h.WalkSpeed = 0
                    h.JumpPower = 0
                    h.PlatformStand = true
                end
            elseif command == "unfreeze" then
                if targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
                    local h = targetPlayer.Character.Humanoid
                    h.WalkSpeed = 16
                    h.JumpPower = 50
                    h.PlatformStand = false
                end
            end
        end)
    end
end

player.Chatted:Connect(function(msg)
    local args = string.split(msg, " ")
    local cmd = args[1]
    if not cmd or cmd:sub(1,1) ~= "/" then return end
    cmd = cmd:sub(2):lower()
    local target = args[2]
    ADM.Execute(cmd, target)
end)

return ADM
